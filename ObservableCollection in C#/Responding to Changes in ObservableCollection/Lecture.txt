Understanding ObservableCollection and CollectionChanged Event in C#

Objective:

Understand the usage of ObservableCollection and its CollectionChanged event in C#.
Learn how to respond to changes in an ObservableCollection.
Introduction:

In C#, ObservableCollection is a specialized collection class provided by the .NET framework in the System.Collections.ObjectModel namespace. It is similar to List<T> but with an added capability to provide notifications when its contents are modified. This makes it particularly useful in scenarios where you need to update the UI or perform certain actions in response to changes in the collection.

Example Explanation:

Let's dissect the provided code to understand how ObservableCollection and its CollectionChanged event work:

Creating the ObservableCollection:

ObservableCollection<string> Items = new ObservableCollection<string>();

Here, we create an ObservableCollection called Items which can hold string elements.
Subscribing to the CollectionChanged event:

Items.CollectionChanged += Items_CollectionChanged;

We subscribe to the CollectionChanged event of the Items ObservableCollection. This event is triggered whenever the collection is modified.
Modifying the ObservableCollection:

Items.Add("Item 1");
Items.Add("Item 2");
Items.Add("Item 3");

Items.RemoveAt(1);
Items.Insert(0, "New Item");
Items[1] = "Replaced Item"; // Replace action
Items.Move(0, 2); // Move action

We modify the ObservableCollection by adding, removing, replacing, and moving elements.
CollectionChanged Event Handler:

static void Items_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)

This method is the event handler for the CollectionChanged event.
Handling Collection Changes:

Inside the event handler, we use a switch-case statement to handle different types of collection changes (Add, Remove, Replace, Move).
Depending on the type of change, we print relevant information about the change (added items, removed items, replaced items, or moved items).
Printing the Final Collection:

Console.WriteLine("\nFinal Collection:");
foreach (var item in Items)
{
    Console.WriteLine(item);
}

Finally, we print the contents of the ObservableCollection after all the modifications have been made.
Full Code Example with Comments:

using System;
using System.Collections.ObjectModel;


class Program
{
    static void Main(string[] args)
    {
        // Creating an ObservableCollection
        ObservableCollection<string> Items = new ObservableCollection<string>();
        // Subscribing to the CollectionChanged event
        Items.CollectionChanged += Items_CollectionChanged;


        // Modifying the ObservableCollection
        Items.Add("Item 1");
        Items.Add("Item 2");
        Items.Add("Item 3");


        Items.RemoveAt(1);
        Items.Insert(0, "New Item");
        Items[1] = "Replaced Item"; // Replace action
        Items.Move(0, 2); // Move action


        // Printing the Final Collection
        Console.WriteLine("\nFinal Collection:");
        foreach (var item in Items)
        {
            Console.WriteLine(item);
        }
        Console.ReadKey();
    }


    // CollectionChanged Event Handler
    static void Items_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        Console.WriteLine("\nCollection Changed:");


        // Handling Collection Changes
        switch (e.Action)
        {
            case System.Collections.Specialized.NotifyCollectionChangedAction.Add:
                Console.WriteLine("Added:");
                foreach (var newItem in e.NewItems)
                {
                    Console.WriteLine("- " + newItem);
                }
                break;


            case System.Collections.Specialized.NotifyCollectionChangedAction.Remove:
                Console.WriteLine("Removed:");
                foreach (var oldItem in e.OldItems)
                {
                    Console.WriteLine("- " + oldItem);
                }
                break;


            case System.Collections.Specialized.NotifyCollectionChangedAction.Replace:
                Console.WriteLine("Replaced:");
                foreach (var oldItem in e.OldItems)
                {
                    Console.WriteLine("- " + oldItem);
                }
                Console.WriteLine("With:");
                foreach (var newItem in e.NewItems)
                {
                    Console.WriteLine("- " + newItem);
                }
                break;


            case System.Collections.Specialized.NotifyCollectionChangedAction.Move:
                Console.WriteLine("Moved:");
                Console.WriteLine($"- From index {e.OldStartingIndex} to index {e.NewStartingIndex}");
                break;
        }
    }
}



Conclusion:

In this lesson, we learned about the ObservableCollection class in C#, its CollectionChanged event, and how to respond to changes in the collection using the event handler. ObservableCollection provides a convenient way to track modifications to collections, making it a valuable tool for scenarios involving dynamic data updates, such as UI bindings in WPF or Xamarin applications..etc